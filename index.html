<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#7c3aed">
    <title>Obsidian Claude Assistant</title>
    <link rel="manifest" href="manifest.json">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="app-container">
        <!-- Header -->
        <header class="app-header">
            <h1>üìù Obsidian Claude</h1>
            <button id="settings-btn" class="icon-btn" title="Settings">‚öôÔ∏è</button>
        </header>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Sidebar -->
            <aside class="sidebar" id="sidebar">
                <div class="sidebar-section">
                    <div class="sidebar-header">
                        <h2>Chats</h2>
                        <button id="new-chat-btn" class="icon-btn" title="New Chat">+</button>
                    </div>
                    <div id="chat-list" class="chat-list"></div>
                </div>
                <div class="sidebar-section sidebar-files">
                    <div class="sidebar-header">
                        <h2>Your Vault</h2>
                        <button id="refresh-files-btn" class="icon-btn" title="Refresh">üîÑ</button>
                    </div>
                    <div id="file-tree" class="file-tree">
                        <div class="loading">Loading vault...</div>
                    </div>
                </div>
            </aside>

            <!-- Chat Area -->
            <main class="chat-area">
                <div id="chat-messages" class="chat-messages">
                    <div class="welcome-message">
                        <h2>üëã Welcome!</h2>
                        <p>I'm Claude, and I have access to your Obsidian vault.</p>
                        <p>You can:</p>
                        <ul>
                            <li>Ask me about any file in your vault</li>
                            <li>Request edits or additions to your notes</li>
                            <li>Get help with writing, organizing, or brainstorming</li>
                        </ul>
                        <p><strong>Tip:</strong> Click any file in the sidebar to add it to context!</p>
                    </div>
                </div>

                <!-- Input Area -->
                <div class="input-area">
                    <div id="context-files" class="context-files"></div>
                    <div class="input-container">
                        <textarea 
                            id="user-input" 
                            placeholder="Ask me anything about your vault..."
                            rows="1"
                        ></textarea>
                        <button id="send-btn" class="send-btn" disabled>
                            <span>Send</span>
                            <span class="icon">‚û§</span>
                        </button>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <!-- Settings Modal -->
    <div id="settings-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Settings</h2>
                <button class="close-btn">&times;</button>
            </div>
            <div class="modal-body">
                <div class="settings-section">
                    <h3>ü§ñ Claude API</h3>
                    <label>
                        API Key
                        <input type="password" id="claude-api-key" placeholder="sk-ant-...">
                    </label>
                    <label>
                        Model
                        <select id="claude-model">
                            <option value="claude-sonnet-4-5-20250929">Claude Sonnet 4.5</option>
                            <option value="claude-opus-4-5-20251101">Claude Opus 4.5</option>
                            <option value="claude-haiku-4-5-20251001">Claude Haiku 4.5</option>
                        </select>
                    </label>
                </div>

                <div class="settings-section">
                    <h3>‚òÅÔ∏è AWS S3</h3>
                    <label>
                        Region
                        <input type="text" id="s3-region" placeholder="us-east-1">
                    </label>
                    <label>
                        Bucket Name
                        <input type="text" id="s3-bucket" placeholder="my-obsidian-vault">
                    </label>
                    <label>
                        Access Key ID
                        <input type="text" id="s3-access-key" placeholder="AKIA...">
                    </label>
                    <label>
                        Secret Access Key
                        <input type="password" id="s3-secret-key" placeholder="...">
                    </label>
                    <label>
                        Prefix (optional)
                        <input type="text" id="s3-prefix" placeholder="vault-name/">
                        <small>Leave empty if vault is at bucket root</small>
                    </label>
                </div>

                <div class="settings-section">
                    <h3>üìù Obsidian</h3>
                    <label>
                        Vault Name
                        <input type="text" id="obsidian-vault" placeholder="My Vault">
                        <small>Used to open files directly in Obsidian</small>
                    </label>
                </div>

                <button id="save-settings-btn" class="primary-btn">Save Settings</button>
                <button id="test-connection-btn" class="secondary-btn">Test Connection</button>
            </div>
        </div>
    </div>

    <!-- Toast Notifications -->
    <div id="toast-container" class="toast-container"></div>

    <!-- Scripts -->
    <script src="https://sdk.amazonaws.com/js/aws-sdk-2.1692.0.min.js"></script>
    <script src="app.js"></script>
</body>
</html>
